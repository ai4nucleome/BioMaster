BCFtools: BCFtools is a set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.Most commands accept VCF, bgzipped VCF and BCF with filetype detected automatically even when streaming from a pipe. Indexed VCF and BCF will work in all situations. Un-indexed VCF and BCF and streams will work in most, but not all situations. In general, whenever multiple VCFs are read simultaneously, they must be indexed and therefore also compressed. (Note that files with non-standard index names can be accessed as e.g. "bcftools view -r X:2928329 file.vcf.gz##idx##non-standard-index-name".)BCFtools is designed to work on a stream. It regards an input file "-" as the standard input (stdin) and outputs to the standard output (stdout). Several commands can thus be combined with Unix pipes. BCFtools: Reading/writing BCF2/VCF/gVCF files and calling/filtering/summarising SNP and short indel sequence variants

Samtools: Samtools is a suite of programs for interacting with high-throughput sequencing data. It consists of three separate repositories: Samtools Reading/writing/editing/indexing/viewing SAM/BAM/CRAM format

HTSlib: A C library for reading/writing high-throughput sequencing data.Samtools and BCFtools both use HTSlib internally, but these source packages contain their own copies of htslib so they can be built independently.

ADMIXTURE: ADMIXTURE is a software tool for maximum likelihood estimation of individual ancestries from multilocus SNP genotype datasets. It uses the same statistical model as STRUCTURE but calculates estimates much more rapidly using a fast numerical optimization algorithm. Specifically, ADMIXTURE uses a block relaxation approach to alternately update allele frequency and ancestry fraction parameters. Each block update is handled by solving a large number of independent convex optimization problems, which are tackled using a fast sequential quadratic programming algorithm. Convergence of the algorithm is accelerated using a novel quasi-Newton acceleration method. The algorithm outperforms EM algorithms and MCMC sampling methods by a wide margin. For details, see our publications.

smartpca:  smartpca run Principal Components Analysis on input genotype data. smartpca runs Principal Components Analysis on input genotype data and outputs principal components (eigenvectors) and eigenvalues.  

Treemix: Scripts to infer population splits and mixture events from alelle frequency data using TreeMix by Pickrell & Pritchard (2012). This pipeline runs TreeMix with bootstrapping, helps choose number of migration events and creates a consensus tree. It plots a maximum likelihood tree with bootstrap values, drift and residuals and calculates statistics for every migration event, such as migration support, standard error and p-values.

ADMIXTOOLS: The ADMIXTOOLS package implements 5 methods described in Patterson et al. (2012) Ancient Admixture in Human History. 

PLINK:PLINK is a free, open-source whole genome association analysis toolset, designed to perform a range of basic, large-scale analyses in a computationally efficient manner.The focus of PLINK is purely on analysis of genotype/phenotype data, so there is no support for steps prior to this (e.g. study design and planning, generating genotype or CNV calls from raw data). Through integration with gPLINK and Haploview, there is some support for the subsequent visualization, annotation and storage of results.PLINK (one syllable) is being developed by Shaun Purcell whilst at the Center for Human Genetic Research (CHGR), Massachusetts General Hospital (MGH), and the Broad Institute of Harvard & MIT, with the support of others.  

VCFtools: VCFtools is a program package designed for working with VCF files, such as those generated by the 1000 Genomes Project. The aim of VCFtools is to provide easily accessible methods for working with complex genetic variation data in the form of VCF files.

GATK:The GATK is the industry standard for identifying SNPs and indels in germline DNA and RNAseq data. Its scope is now expanding to include somatic short variant calling, and to tackle copy number (CNV) and structural variation (SV). In addition to the variant callers themselves, the GATK also includes many utilities to perform related tasks such as processing and quality control of high-throughput sequencing data, and bundles the popular Picard toolkit.

bwa: bwa is a sequence alignment software that is part of the BWA (Burrows-Wheeler Aligner) package. It is designed for mapping low-divergent sequences against a large reference genome, such as the human genome. BWA includes three algorithms: BWA-backtrack, BWA-SW, and bwa. BWA-backtrack is optimized for short reads up to 100bp, while BWA-SW and bwa are intended for longer reads ranging from 70bp to 1Mbp.

MSMC: MSMC is a software that uses multiple phased haplotypes to estimate the scaled population size and the timing and nature of population separations.

PSMC:The Pairwise Sequentially Markovian Coalescent (PSMC) model uses information in the complete diploid sequence of a single individual to infer the history of population size changes. 


Population Genetics Research Workflow - Tools and Objectives
Objectives:

Explore genetic diversity and ancestry composition of different populations.
Reconstruct the separation timeline and demographic history of populations.
Key Tools:

BWA-MEM:
Purpose: Align sequencing data to the reference genome.
Objective: Precisely map sequence reads to prepare for further analysis.

GATK (Genome Analysis Toolkit):
Purpose: Perform genotype calling and variant detection.
Objective: Identify and filter high-quality SNPs and Indels.

ADMIXTURE:
Purpose: Analyze population ancestry composition.
Objective: Resolve the genetic structure of various populations.

PCA (Principal Component Analysis):
Purpose: Visualize genetic relationships between populations.
Objective: Observe clustering patterns in genetic space.

MSMC/PSMC:
Purpose: Reconstruct population separation times and demographic history.
Objective: Infer the evolutionary history of different populations.
Using these tools, you can efficiently analyze population genetic data to achieve your research objectives.

Detailed Population Genetics Analysis Workflow
Step 1: Basic Filtering and Preprocessing
Description: Conduct initial data filtering and preprocessing to prepare the data for subsequent analyses. This includes filtering for Minor Allele Frequency (MAF), retaining bi-allelic sites, and simple nucleotide polymorphisms (SNPs). Input Required: Raw VCF file, population information. Expected Output: Filtered VCF file containing high-quality SNP and indel data. Tools Used: VCFtools for VCF file processing.
Step 2: LD Pruning Before KING
Description: Perform linkage disequilibrium pruning to reduce linkage disequilibrium between loci, preparing data for KING analysis. Input Required: Filtered VCF file from Step 1. Expected Output: VCF file after LD pruning. Tools Used: PLINK for LD pruning.
Step 3: Remove Relatives with KING
Description: Use KING tool to remove related individuals from genetic data, avoiding the influence of kinship on subsequent analyses. Input Required: LD pruned VCF file from Step 2. Expected Output: VCF file with relatives removed. Tools Used: KING.
Step 4: Implement Basic Statistics
Description: Perform basic statistical analyses including calculating Runs of Homozygosity (ROH) and performing a Linkage Disequilibrium (LD) decay curve analysis. This step assesses the extent of LD over distance among SNPs. Input Required: VCF file with relatives removed from Step 3. Expected Output: ROH statistics and LD decay curves. Tools Used: PLINK for LD and ROH analysis.
Step 5: LD Pruning Again
Description: Perform LD pruning again to prepare genetic loci with enhanced independence for advanced analyses. Input Required: Statistical data file from Step 4. Expected Output: VCF file after second LD pruning. Tools Used: PLINK for LD pruning.
Step 6: Advanced Analysis
Description: Use regression models and PCA for dimensionality reduction to explore population structure and genetic differentiation. Input Required: VCF file from Step 5. Expected Output: PCA results and regression analysis report. Tools Used: smartPCA
Step 7: Admixture Analysis
Description: Conduct admixture analysis by defining various numbers of populations k to simulate. Input Required: PCA results from Step 6. Expected Output: Admixture analysis results for different k values. Tools Used: ADMIXTURE.
Step 8: TreeMix Modeling
Description: Model historical migration events in genetic data using the TreeMix model, with M defined as the number of migration edges. Input Required: ADMIXTURE results from Step 7. Expected Output: Historical migration model and phylogenetic tree. Tools Used: TreeMix.
Step 9: Admixtools Analysis
Description: Perform deeper population genetic structure analyses using Admixtools, including F3 and D-statistics (f4-mix). Input Required: TreeMix results from Step 8. Expected Output: Admixture graphs and related statistics. Tools Used: Admixtools.
Step 10: Fastsimcoal Analysis
Description: Use fastsimcoal for model-based population genetic simulation analysis, optionally using the basic TreeMix model (m=0) or a custom model. Input Required: Results from Admixtools in Step 9. Expected Output: Simulated population genetic data and model fitting results. Tools Used: fastsimcoal.
